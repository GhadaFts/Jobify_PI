<div class="chart-container">
  <div *ngIf="chartData$ | async as response" class="chart-wrapper">
    <h3 class="chart-title">Active vs Expired Jobs</h3>
    <div class="chart-content">
      <div class="stats-grid">
        <div class="stat-box">
          <span class="stat-label">Latest Active</span>
          <span class="stat-value active">{{ response.data[response.data.length - 1].active }}</span>
        </div>
        <div class="stat-box">
          <span class="stat-label">Latest Expired</span>
          <span class="stat-value expired">{{ response.data[response.data.length - 1].expired }}</span>
        </div>
      </div>
      <div class="line-chart">
        <svg viewBox="0 0 800 200" xmlns="http://www.w3.org/2000/svg">
          <!-- Grid lines -->
          <line x1="0" y1="50" x2="800" y2="50" stroke="#E5E7EB" stroke-width="1" />
          <line x1="0" y1="100" x2="800" y2="100" stroke="#E5E7EB" stroke-width="1" />
          <line x1="0" y1="150" x2="800" y2="150" stroke="#E5E7EB" stroke-width="1" />

          <!-- Active Jobs Line -->
          <polyline
            [attr.points]="getLinePoints(response.data, 'active')"
            fill="none"
            stroke="#10B981"
            stroke-width="3"
            stroke-linejoin="round"
            stroke-linecap="round"
          />

          <!-- Expired Jobs Line -->
          <polyline
            [attr.points]="getLinePoints(response.data, 'expired')"
            fill="none"
            stroke="#EF4444"
            stroke-width="3"
            stroke-linejoin="round"
            stroke-linecap="round"
          />

          <!-- Active Points -->
          <circle
            *ngFor="let point of getChartPoints(response.data, 'active')"
            [attr.cx]="point.x"
            [attr.cy]="point.y"
            r="4"
            fill="#10B981"
            stroke="#fff"
            stroke-width="2"
          />

          <!-- Expired Points -->
          <circle
            *ngFor="let point of getChartPoints(response.data, 'expired')"
            [attr.cx]="point.x"
            [attr.cy]="point.y"
            r="4"
            fill="#EF4444"
            stroke="#fff"
            stroke-width="2"
          />
        </svg>
      </div>
    </div>
    <div class="chart-legend">
      <span class="legend-item">
        <span class="legend-color" style="background-color: #10B981;"></span>
        Active Jobs
      </span>
      <span class="legend-item">
        <span class="legend-color" style="background-color: #EF4444;"></span>
        Expired Jobs
      </span>
    </div>
  </div>
</div>
